<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8_sig">
    <meta name="viewport" content="width=device-width">
    <title>SageMathCell</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: '运行'});
    </script>
  </head>
  <body>



<h1>
<font color=#FF5809; size=8; face=楷体>
线性代数
</font>
</h1>

<a href="https://textbooks.math.gatech.edu/ila/index.html" target="_blank" 
style="text-decoration:none">交互式线性代数</a>

<a href="https://immersivemath.com/ila/" target="_blank" 
style="text-decoration:none">沉浸式线性代数</a>

    
<a href="https://textbooks.math.gatech.edu/ila/demos/rrinter.html?mat=0,-7,-4,2:2,4,6,12:3,1,-1,-2" target="_blank" 
style="text-decoration:none">矩阵的初等行变换</a>

<a href="https://textbooks.math.gatech.edu/ila/diagonalization.html#diag-ss-geometry" target="_blank" 
style="text-decoration:none">矩阵的对角化</a>



 <h2><li>求非齐次线性方程组的通解</li></h2>
 <div class="compute"><script type="text/x-sage">
from sage.misc.html import HtmlFragment

def HSLE_as_latex(A, variables):
    nvars = A.ncols()
    pretty_print(HtmlFragment( 
    r'$$\left\{\begin{array}{%s}'%('r'*(nvars+1))+
    r'\\'.join('%s=&0'%( 
        ' & '.join((r'%s%s\cdot %s'%('+' if c>0 else '',c,v) if c else '') for c,v in zip(row, variables))
        if not row.is_zero() else '&'*(nvars-1)+'0' 
               ) for row in A)+
    r'\end{array}\right.$$'))

@interact
def SEL(A='[(0,1,-1,2),(-1,0,2,4), (0,-1,1,-2)]',
        auto_update=False
    ):
    M = A = matrix(eval(A))
    neqs = M.nrows()
    nvars = M.ncols()
    var_names = ','.join('x%d'%j for j in [1..nvars])
    variables = var(var_names)

    HSLE_as_latex(M, variables)
    pretty_print(HtmlFragment( 'SEL in matrix form'))
    show(M)

    pivot = {}
    ibound_variables = []
    for m,row in enumerate(M):
        for k in range(m,nvars):
            lista = [(abs(M[j,k]),j) for j in range(m,neqs)]
            maxi, c = max(lista)
            if maxi > 0:
                ibound_variables.append(k)
                if M[m,k]==0:
                    M[c,:],M[m,:]=M[m,:],M[c,:]
                    pretty_print( HtmlFragment('We permute rows %d and %d'%(m+1,c+1)))
                    show(M)
                pivot[m] = k
                break

        a=M[m,k]
        for n in range(m+1,neqs):
            if M[n,k]!=0:
                pretty_print( HtmlFragment("We add %s times row %d to row %d"%(-M[n,k]/a, m+1, n+1)))
                M=M.with_added_multiple_of_row(n,m,-M[n,k]/a)
                show(M)

    pretty_print( HtmlFragment('Equivalent system of equations'))
    HSLE_as_latex(M, variables)
    SEL_type = 'compatible'
    null_rows = None
    for k,row in enumerate(M):
        if row.is_zero():
            pretty_print( HtmlFragment('We remove trivial 0=0 equations'))
            M = M[:k,:]
            HSLE_as_latex(M, variables)
                
    ifree_variables = [k for k in range(nvars) if k not in ibound_variables]
    bound_variables = [variables[k] for k in ibound_variables]
    free_variables = [variables[k] for k in ifree_variables]
    pretty_print( HtmlFragment('Free variables: %s'% free_variables))
    pretty_print( HtmlFragment('Bound variables: %s'% bound_variables))
    reduced_eqs = [
        sum(c*v for c,v in zip(row, variables))==0
        for row in M
    ]
    xvector = vector(variables)
    if len(bound_variables)==1:
        soldict = solve(reduced_eqs, bound_variables[0], solution_dict=True)[0]
    else:
        soldict = solve(reduced_eqs, bound_variables, solution_dict=True)[0]

    pretty_print( HtmlFragment('Solution in parametric form'))
    parametric_sol = matrix(
        xvector.apply_map(lambda s:s.subs(soldict))
    ).transpose()
    show(parametric_sol)
    pretty_print( HtmlFragment('Generators'))
    pretty_print( HtmlFragment(
        r'$$\langle %s\rangle$$'%','.join(latex(
            parametric_sol.subs(dict((variables[k],1 if j==k else 0) for k in ifree_variables))
        ) for j in ifree_variables)
    ))
    pretty_print( HtmlFragment('Dimension is %d'%len(free_variables)))
 </script></div>
    
 <h2><li>求行列式</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix(QQ, [[13,-2,5],[-2,10,2], [5,2,13]])
show(A)
show(det(A)) #矩阵A的行列式
 </script></div>

 <h2><li>矩阵的运算</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix([[5,-2,1],[3,4,-1],[1,2,4]])
B = matrix([[-3,2,0],[-2,0,1],[3,1,2]])
show(A);show(B)
show(3*A-4*B)
show(A.transpose()*B) #A的转置乘以B
show(A^5)             #A的5次幂
 </script></div>

 <h2><li>将矩阵化为行阶梯形矩阵和简化行阶梯形矩阵</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix([[5,-2,1],[3,4,-1],[1,2,4]])
show(A)
show(A.echelon_form()) #行阶梯形矩阵
show(A.rref())         #简化行阶梯形矩阵
 </script></div>

 <h2><li>求逆矩阵</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix(QQ, [[13,-2,5],[-2,10,2], [5,2,13]])
show(A)
show(A^-1)
 </script></div>

 <h2><li>求矩阵的秩</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix(QQ, [[5,-2,1],[3,4,-2],[1,2,-1]])
show(A)
show(A.rank())            #矩阵A的秩
show(A.right_nullity())   #矩阵A的零维数=A的零特征值的重数
 </script></div>

 <h2><li>特征值与特征向量</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix(QQ, [[13,-2,5],[-2,10,2], [5,2,13]])
show(A)
show(characteristic_polynomial(A)) #特征多项式
show(A.eigenvalues())              #特征值
show(A.eigenvectors_left())        #特征向量
show(A.eigenmatrix_right())        #可对角化时返回对角阵和可逆矩阵P
 </script></div>

 <h2><li>Gram-Schmidt正交化</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix([[1,1,1],[1,2,1],[0,-1,1]])
show(A.gram_schmidt())
 </script></div>

 <h2><li>解矩阵方程</li></h2>
 <div class="compute"><script type="text/x-sage">
A = matrix(QQ, [[13,-2,5],[-2,10,2], [5,2,13]])
B = matrix([[5,-2,1],[3,4,-1],[1,2,4]])
show(A); show(B)
show(A.solve_right(B)) #求矩阵方程A*X = B的解X
show(A.solve_left(B))  #求矩阵方程X*A = B的解X
 </script></div>

 <h2><li>解方程组</li></h2>
 <div class="compute"><script type="text/x-sage">
var("x y")
show(solve([x^2+y^2==1, (x-1)^2+y^2==1],x,y))
 </script></div>


 <h2><li>绘图</li></h2>
 <div class="compute"><script type="text/x-sage">
f1 = 1
f2 = 1-x
f3 = exp(x)
f4 = sin(2*x)
f = piecewise([((0,1),f1), ((1,2),f2), ((2,3),f3), ((3,10),f4)])
f.plot(x,0,10)
 </script></div>



 <h2><li>交互绘图</li></h2>
 <div class="compute"><script type="text/x-sage">
@interact
def f(n=[0..4], s=(1..5), c=Color("red")):
    var("x");show(plot(sin(n+x^s),-pi,pi,color=c))
 </script></div>



<h1>
<font color=#FF5809; size=8; face=楷体>
交互显示
</font>
</h1>

<h2>输入您的代码并运行</h2>
<div class="compute"><script type="text/x-sage">
@interact
def f(n=(0,10)):
    print(2^n)
</script></div>

<h1>
<font color=#FF5809; size=8; face=楷体>
<a href="https://doc.sagemath.org/html/en/constructions/calculus.html" target="_blank" 

style="text-decoration:none">微积分</a>
<a href="https://doc.sagemath.org/html/en/constructions/linear_algebra.html" target="_blank" 

style="text-decoration:none">线性代数</a>
<a href="https://doc.sagemath.org/html/en/constructions/plotting.html" target="_blank" 

style="text-decoration:none">绘图</a>
<a href="https://www.sagemath.org/" target="_blank" style="text-decoration:none">SageMath主页

</a>

</font>
</h1>
  </body>
</html>
