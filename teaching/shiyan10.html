<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2023b"><title>实验10 人口预测与数据拟合</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S3 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 0 10px 0; }
.S5 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }</style></head><body><div class = rtcContent><h2  class = 'S0'><span style=' font-weight: bold;'>实验10 人口预测与数据拟合</span></h2><div  class = 'S1'><span style=' font-weight: bold; text-decoration: underline;'>实验问题</span><span>：我国1971年至2017年人口统计数据如表10-1所示:</span></div><div  class = 'S1'><span>(1)试利用 1971年至2000年的数据，建立我国人口增长的数学模型;</span></div><div  class = 'S1'><span>(2)利用建立的模型预测2001年至2017年的人口总数，并与统计数据进行比较.该问题是通过已知数据来预测这些数据的变化规律和趋势，寻找一个最能反映这个规律的函数曲线，这是数据处理问题中常见的一类问题，在数学上归结为最佳曲线拟合问题.</span></div><div  class = 'S1'><span style=' font-weight: bold; text-decoration: underline;'>实验目的</span><span>：通过对人口预测问题的分析求解，掌握建立人口增长数学模型的思想方法; 了解利用最小二乘法进行数据拟合的基本思想; 熟悉寻找最佳拟合曲线的方法; 学会利用 MATLAB 进行曲线拟合.</span></div><div  class = 'S1'><span style=' font-weight: bold; text-decoration: underline;'>实验内容</span><span>：首先介绍最小二乘意义下数据拟合的基本思想，其次介绍多项式曲线拟合及给定函数类型的曲线拟合MATLAB命令，最后介绍人工预测的马尔萨斯模型和逻辑斯谛模型，并利用最小二乘法拟合其预测曲线. </span></div><h3  class = 'S2'><span></span></h3><h3  class = 'S3'><span>10.1 数据拟合方法</span></h3><h4  class = 'S4'><span>1. 最小二乘法的基本思想</span></h4><h4  class = 'S4'><span>2. 多项式曲线拟合</span></h4><h4  class = 'S4'><span>例10-1</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >clc;clf;clear;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x=0:0.1:1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >y=[-.447  1.978  3.28  6.16  7.08  7.34  7.66  9.56  9.48  9.3  11.2];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(x,y,</span><span style="color: rgb(167, 9, 245);">'k.'</span><span >,</span><span style="color: rgb(167, 9, 245);">'markersize'</span><span >,25);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis([0 1.3 -2 16]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >p=polyfit(x,y,3); </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >p1=polyfit(x,y,6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >t=0:.01:1.2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >s=polyval(p,t);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >s1=polyval(p1,t);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(t,s,</span><span style="color: rgb(167, 9, 245);">'k-'</span><span >,</span><span style="color: rgb(167, 9, 245);">'linewidth'</span><span >,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(t,s1,</span><span style="color: rgb(167, 9, 245);">'k--'</span><span >,</span><span style="color: rgb(167, 9, 245);">'linewidth'</span><span >,2) </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >grid</span></span></div></div></div><h4  class = 'S4'><span>例10-2</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >clc;clear;clf</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >t1= (1971:2000)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >N1 = [8.523  8.718  8.921  9.086  9.242  9.372  9.497  9.626  9.754  9.871 </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        10.007 10.165 10.301 10.436 10.585 10.751 10.930 11.103 11.270 11.433 </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >11.582 11.717 11.852 11.985 12.112 12.239 12.363 12.476 12.579 12.674]';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >t2=(2001:2017)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >N2=[12.763 12.845 12.923 12.999 13.076 13.145 13.213 13.280 13.345 13.409 </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        13.474 13.540 13.607 13.678 13.746 13.827 13.901]';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >t=[t1; t2];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >N=[N1; N2];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(t,N,</span><span style="color: rgb(167, 9, 245);">'r.'</span><span >,</span><span style="color: rgb(167, 9, 245);">'markersize'</span><span >,20);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >grid; </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >T = table(t1, N1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >[p,~,mu] = polyfit(T.t1, T.N1, 3); </span><span style="color: rgb(0, 128, 19);">% 拟合一个使用中心化和缩放的 3 次多项式，</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%这将改善问题的数值属性，</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%可避免在拟合计算中出现病态的 Vandermonde 矩阵。</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x1=1971:2017;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >s1 = polyval(p,x1,[],mu);       </span><span style="color: rgb(0, 128, 19);">%使用带四个输入的 polyval，根据缩放后的年份计算 p。</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(x1,s1,</span><span style="color: rgb(167, 9, 245);">'k-'</span><span >,</span><span style="color: rgb(167, 9, 245);">'linewidth'</span><span >,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span></span></div></div></div><h4  class = 'S4'><span></span></h4><h4  class = 'S4'><span>3. 给定函数类型的曲线拟合</span></h4><h4  class = 'S4'><span>例10-3</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >xdata=[0.9 1.5 13.8 19.8 24.1 28.2 35.2 60.3 74.6 81.3]; </span><span style="color: rgb(0, 128, 19);">%输入变量x的数据</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ydata=[455.2 428.6 124.1 67.3 43.2 28.1 13.1 -0.4 -1.3 -1.5]; </span><span style="color: rgb(0, 128, 19);">%输入变量y的数据</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >fun=@(x,xdata)x(1)*exp(x(2)*xdata);</span><span style="color: rgb(0, 128, 19);">%建立函数</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x0=[100,-1]; </span><span style="color: rgb(0, 128, 19);">%取初始点</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x=lsqcurvefit(fun,x0,xdata,ydata) </span><span style="color: rgb(0, 128, 19);">%调用指令进行曲线拟合</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >times=linspace(xdata(1),xdata(end)); </span><span style="color: rgb(0, 128, 19);">%在xdata(1)与xdata(end)等间距生成100个点</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(xdata,ydata,</span><span style="color: rgb(167, 9, 245);">'ko'</span><span >,times,fun(x,times),</span><span style="color: rgb(167, 9, 245);">'b-'</span><span >) </span><span style="color: rgb(0, 128, 19);">%绘制拟合曲线</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >legend(</span><span style="color: rgb(167, 9, 245);">'Data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Fitted exponential'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'Data and Fitted Curve'</span><span >)   </span><span style="color: rgb(0, 128, 19);">%设置图标题</span></span></div></div></div><h4  class = 'S4'><span>例10-4</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >xdata=[0.28 0.45 0.62 0.79 0.96 1.13 1.30 1.47 1.64 1.81 1.98 2.15 2.32 2.49 2.66 2.83 2.91 3.00]; </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ydata=[-2.84 -4.11 -4.21 -4.83 -5.30 -5.56 -5.81 -5.39 -4.63 -4.11 -3.02 -1.02 0.08 2.10  4.42 7.06 8.32 10.15]; </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >fun=@(x,xdata)x(1)*log(xdata)+x(2)*sin(xdata)+x(3)*exp(xdata);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x0=[2,-10,2]; </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x=lsqcurvefit(fun,x0,xdata,ydata) </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >times=linspace(xdata(1),xdata(end)); </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(xdata,ydata,</span><span style="color: rgb(167, 9, 245);">'k*'</span><span >,times,fun(x,times),</span><span style="color: rgb(167, 9, 245);">'b-'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >legend(</span><span style="color: rgb(167, 9, 245);">'Data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Fitted Curve'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'Data and Fitted Curve'</span><span >) </span></span></div></div></div><h3  class = 'S2'><span></span></h3><h3  class = 'S3'><span>10.2 实验问题求解</span></h3><h4  class = 'S4'><span>1. 马尔萨斯模型及其拟合曲线</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >clc;clear;clf</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >t1=1971:2000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >N1=[8.523  8.718  8.921  9.086  9.242  9.372  9.497  9.626  9.754  9.871 </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        10.007 10.165 10.301 10.436 10.585 10.751 10.930 11.103 11.270 11.433 </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >11.582 11.717 11.852 11.985 12.112 12.239 12.363 12.476 12.579 12.674];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >t2=2001:2017;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >N2=[12.763 12.845 12.923 12.999 13.076 13.145 13.213 13.280 13.345 13.409 </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >    13.474 13.540 13.607 13.678 13.746 13.827 13.901]</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >t=[t1 t2];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >N=[N1 N2]</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plot(t,N,</span><span style="color: rgb(167, 9, 245);">'k.'</span><span >,</span><span style="color: rgb(167, 9, 245);">'markersize'</span><span >,20);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis([1971 2020 6 20]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >grid; </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >pause(0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >n=30;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >a1=sum(t1(1:n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >b1=sum(t1(1:n).*t(1:n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >c=sum(log(N1(1:n)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >d=sum(t1(1:n).*log(N1(1:n)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >A=[n a1; a1 b1];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >B=[c;d];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >p=inv(A)*B;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >a= p (1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >b= p (2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x=1971:2017;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >y=exp(p(1)+p(2)*x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >plot(x,y,</span><span style="color: rgb(167, 9, 245);">'r-'</span><span >,</span><span style="color: rgb(167, 9, 245);">'linewidth'</span><span >,2)</span></span></div></div></div><div  class = 'S8'><span></span></div><h4  class = 'S4'><span>2. 逻辑斯蒂模型及其拟合曲线</span></h4><h4  class = 'S4'><span></span></h4><h4  class = 'S4'></h4>
<br>
<!-- 
##### SOURCE BEGIN #####
%% *实验10 人口预测与数据拟合*
% *实验问题*：我国1971年至2017年人口统计数据如表10-1所示:
% 
% (1)试利用 1971年至2000年的数据，建立我国人口增长的数学模型;
% 
% (2)利用建立的模型预测2001年至2017年的人口总数，并与统计数据进行比较.该问题是通过已知数据来预测这些数据的变化规律和趋势，寻找一个最能反映这个规律的函数曲线，这是数据处理问题中常见的一类问题，在数学上归结为最佳曲线拟合问题.
% 
% *实验目的*：通过对人口预测问题的分析求解，掌握建立人口增长数学模型的思想方法; 了解利用最小二乘法进行数据拟合的基本思想; 熟悉寻找最佳拟合曲线的方法; 
% 学会利用 MATLAB 进行曲线拟合.
% 
% *实验内容*：首先介绍最小二乘意义下数据拟合的基本思想，其次介绍多项式曲线拟合及给定函数类型的曲线拟合MATLAB命令，最后介绍人工预测的马尔萨斯模型和逻辑斯谛模型，并利用最小二乘法拟合其预测曲线. 
% 
% 10.1 数据拟合方法
% 1. 最小二乘法的基本思想
% 2. 多项式曲线拟合
% 例10-1

clc;clf;clear;
x=0:0.1:1;
y=[-.447  1.978  3.28  6.16  7.08  7.34  7.66  9.56  9.48  9.3  11.2];
plot(x,y,'k.','markersize',25);
axis([0 1.3 -2 16]);
p=polyfit(x,y,3); 
p1=polyfit(x,y,6);
t=0:.01:1.2;
s=polyval(p,t);
s1=polyval(p1,t);
hold on
plot(t,s,'k-','linewidth',2)
plot(t,s1,'kREPLACE_WITH_DASH_DASH','linewidth',2) 
grid
% 例10-2

clc;clear;clf
t1= (1971:2000)';
N1 = [8.523  8.718  8.921  9.086  9.242  9.372  9.497  9.626  9.754  9.871 ...
        10.007 10.165 10.301 10.436 10.585 10.751 10.930 11.103 11.270 11.433 ...
11.582 11.717 11.852 11.985 12.112 12.239 12.363 12.476 12.579 12.674]';
t2=(2001:2017)';
N2=[12.763 12.845 12.923 12.999 13.076 13.145 13.213 13.280 13.345 13.409 ...
        13.474 13.540 13.607 13.678 13.746 13.827 13.901]';
t=[t1; t2];
N=[N1; N2];
plot(t,N,'r.','markersize',20);
grid; 
T = table(t1, N1)
[p,~,mu] = polyfit(T.t1, T.N1, 3); % 拟合一个使用中心化和缩放的 3 次多项式，
%这将改善问题的数值属性，
%可避免在拟合计算中出现病态的 Vandermonde 矩阵。
x1=1971:2017;
s1 = polyval(p,x1,[],mu);       %使用带四个输入的 polyval，根据缩放后的年份计算 p。
hold on
plot(x1,s1,'k-','linewidth',2)
hold off
% 
% 3. 给定函数类型的曲线拟合
% 例10-3

xdata=[0.9 1.5 13.8 19.8 24.1 28.2 35.2 60.3 74.6 81.3]; %输入变量x的数据
ydata=[455.2 428.6 124.1 67.3 43.2 28.1 13.1 -0.4 -1.3 -1.5]; %输入变量y的数据
fun=@(x,xdata)x(1)*exp(x(2)*xdata);%建立函数
x0=[100,-1]; %取初始点
x=lsqcurvefit(fun,x0,xdata,ydata) %调用指令进行曲线拟合
times=linspace(xdata(1),xdata(end)); %在xdata(1)与xdata(end)等间距生成100个点
plot(xdata,ydata,'ko',times,fun(x,times),'b-') %绘制拟合曲线
legend('Data','Fitted exponential')
title('Data and Fitted Curve')   %设置图标题
% 例10-4

xdata=[0.28 0.45 0.62 0.79 0.96 1.13 1.30 1.47 1.64 1.81 1.98 2.15 2.32 2.49 2.66 2.83 2.91 3.00]; 
ydata=[-2.84 -4.11 -4.21 -4.83 -5.30 -5.56 -5.81 -5.39 -4.63 -4.11 -3.02 -1.02 0.08 2.10  4.42 7.06 8.32 10.15]; 
fun=@(x,xdata)x(1)*log(xdata)+x(2)*sin(xdata)+x(3)*exp(xdata);
x0=[2,-10,2]; 
x=lsqcurvefit(fun,x0,xdata,ydata) 
times=linspace(xdata(1),xdata(end)); 
plot(xdata,ydata,'k*',times,fun(x,times),'b-')
legend('Data','Fitted Curve')
title('Data and Fitted Curve') 
% 
% 10.2 实验问题求解
% 1. 马尔萨斯模型及其拟合曲线

clc;clear;clf
t1=1971:2000;
N1=[8.523  8.718  8.921  9.086  9.242  9.372  9.497  9.626  9.754  9.871 ...
        10.007 10.165 10.301 10.436 10.585 10.751 10.930 11.103 11.270 11.433 ...
11.582 11.717 11.852 11.985 12.112 12.239 12.363 12.476 12.579 12.674];
t2=2001:2017;
N2=[12.763 12.845 12.923 12.999 13.076 13.145 13.213 13.280 13.345 13.409 ...
    13.474 13.540 13.607 13.678 13.746 13.827 13.901]
t=[t1 t2];
N=[N1 N2]
plot(t,N,'k.','markersize',20);
axis([1971 2020 6 20]);
grid; 
hold on
pause(0.5)
n=30;
a1=sum(t1(1:n));
b1=sum(t1(1:n).*t(1:n));
c=sum(log(N1(1:n)));
d=sum(t1(1:n).*log(N1(1:n)));
A=[n a1; a1 b1];
B=[c;d];
p=inv(A)*B;
a= p (1)
b= p (2)
x=1971:2017;
y=exp(p(1)+p(2)*x);
plot(x,y,'r-','linewidth',2)
%% 
% 
% 2. 逻辑斯蒂模型及其拟合曲线
% 
%
##### SOURCE END #####
-->
</div></body></html>